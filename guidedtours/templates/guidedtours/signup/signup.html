{% extends "base_single_card_layout.html" %}
{% load static %}
{% load i18n %}
{% load bootstrap4 %}

{% block set_common_headercontent %}{% trans "Sign up for a guided tour" %}{% endblock %}

{% block set_common_content %}
<div class="row">
    <div class="col-xs-12 col-lg-5 mb-3">
        <form
            method="post"
            action=""
        >
            {% csrf_token %}
            {% bootstrap_form form %}
            {% include "privacy_policies/guildedtours_privacy_policy.html" %}
            <button
                class="btn btn-primary"
                type="submit"
            >{% trans "Sign up" %}</button>
        </form>
    </div>
    <div class="col-xs-12 col-lg-5">
        <h2 class='h4'>{% trans "All availible Guided tours:" %}</h2>
        <div id="accordion">
            {% for tour in tours %}
            <div class="card">
                <div
                    class="card-header"
                    id="heading{{ forloop.counter }}"
                >
                    <button
                        class="btn btn-link"
                        data-toggle="collapse"
                        data-target="#collapse{{ forloop.counter }}"
                        aria-expanded="{% if forloop.first %}true{% else %}false{% endif %}"
                        aria-controls="collapse{{ forloop.counter }}"
                    >
                        {% blocktranslate trimmed with name=tour.name date=tour.date lenth=tour.length %}
                        {{ name }} on {{ date }}
                        {% endblocktranslate %}
                    </button>
                </div>

                <div
                    id="collapse{{ forloop.counter }}"
                    class="{% if forloop.first %}show{% else %}collapse{% endif %}"
                    aria-labelledby="heading{{ forloop.counter }}"
                    data-parent="#accordion"
                >
                    <div class="card-body">
                        <table class='table table-hover'>
                            <tbody>
                                <tr>
                                    <th>{% trans "Length:" %}</th>
                                    <td>
                                        {{ tour.length }} {% trans "minutes" %}
                                        <span
                                            class='bi bi-info-circle-fill'
                                            data-toggle='tooltip'
                                            data-html="true"
                                            title='{% trans "Please note that tours sometimes take longer than this time.<br> Plan <b>at least with a 30 minutes buffer</b> between Guidedtours.<br> <br> TLDR:<br>Time-travel is impossible.<br>Your probably can not teleport.<br>If you apply for two confilicting tours we will cancel your registration, to be fair for everyone." %}'
                                        ></span>
                                    </td>
                                </tr>
                                <tr>
                                    <th>{% trans "Description:" %}</th>
                                    <td>{{ tour.description }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block defered_script %}
<link
    href='{% static "choices.js/public/assets/styles/choices.min.css" %}'
    rel='stylesheet'
/>
<script src='{% static "choices.js/public/assets/scripts/choices.min.js" %}'></script>
<script type="text/javascript">
        /* global Choices */
        /* eslint no-new: off */
        new Choices(document.getElementById('id_subject'));
        new Choices(document.getElementById('id_tour'));
        $('[data-toggle="tooltip"]').tooltip({ boundary: 'window' });
    </script>
{% endblock %}
